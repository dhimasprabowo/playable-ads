<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Playable Ad</title>
	<link rel="stylesheet" href="style.css">
</head>

<body>
	<canvas id="gameCanvas" width="300" height="500"></canvas>
	<script>

		const canvas = document.getElementById('gameCanvas');
		const ctx = canvas.getContext('2d');

		// Ball properties
		const ballImage = new Image();
		ballImage.src = 'assets/motor.png';
		const ball = {
			x: canvas.width / 2,
			y: canvas.height / 2,
			width: 50, // Default size if the image is unavailable
			height: 50,
			speed: 2,
			dx: 0,
			dy: 0,
		};

		// Joystick properties
		const joystick = {
			x: canvas.width - 150,
			y: canvas.height - 100,
			radius: 50,
			knob: { x: 0, y: 0, radius: 20 },
			active: false,
		};

		// Initialize joystick knob position
		joystick.knob.x = joystick.x;
		joystick.knob.y = joystick.y;

		// Draw the ball
		const drawBall = () => {
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			ctx.drawImage(ballImage, ball.x - ball.width / 2, ball.y - ball.height / 2, ball.width, ball.height);
		};

		// Draw the joystick
		const drawJoystick = () => {
			// Outer circle
			ctx.beginPath();
			ctx.arc(joystick.x, joystick.y, joystick.radius, 0, Math.PI * 2);
			ctx.fillStyle = 'rgba(200, 200, 200, 0.8)';
			ctx.fill();
			ctx.strokeStyle = '#444';
			ctx.lineWidth = 2;
			ctx.stroke();
			ctx.closePath();

			// Knob
			ctx.beginPath();
			ctx.arc(joystick.knob.x, joystick.knob.y, joystick.knob.radius, 0, Math.PI * 2);
			ctx.fillStyle = '#444';
			ctx.fill();
			ctx.closePath();
		};

		// Update ball position
		const updateBall = () => {
			ball.x += ball.dx;
			ball.y += ball.dy;

			// Keep the ball within the canvas boundaries
			if (ball.x < ball.width / 2) ball.x = ball.width / 2;
			if (ball.x > canvas.width - ball.width / 2) ball.x = canvas.width - ball.width / 2;
			if (ball.y < ball.height / 2) ball.y = ball.height / 2;
			if (ball.y > canvas.height - ball.height / 2) ball.y = canvas.height - ball.height / 2;
		};

		// Calculate joystick movement
		const moveJoystick = (x, y) => {
			const dx = x - joystick.x;
			const dy = y - joystick.y;
			const distance = Math.sqrt(dx * dx + dy * dy);

			if (distance <= joystick.radius) {
				joystick.knob.x = x;
				joystick.knob.y = y;
			} else {
				const angle = Math.atan2(dy, dx);
				joystick.knob.x = joystick.x + Math.cos(angle) * joystick.radius;
				joystick.knob.y = joystick.y + Math.sin(angle) * joystick.radius;
			}

			// Calculate ball speed
			ball.dx = ((joystick.knob.x - joystick.x) / joystick.radius) * ball.speed;
			ball.dy = ((joystick.knob.y - joystick.y) / joystick.radius) * ball.speed;
		};

		// Reset joystick position
		const resetJoystick = () => {
			joystick.knob.x = joystick.x;
			joystick.knob.y = joystick.y;
			ball.dx = 0;
			ball.dy = 0;
		};

		// Event listeners for joystick interaction
		canvas.addEventListener('mousedown', (e) => {
			const rect = canvas.getBoundingClientRect();
			const mouseX = e.clientX - rect.left;
			const mouseY = e.clientY - rect.top;

			const distance = Math.sqrt(
				Math.pow(mouseX - joystick.x, 2) + Math.pow(mouseY - joystick.y, 2)
			);

			if (distance <= joystick.radius) {
				joystick.active = true;
				moveJoystick(mouseX, mouseY);
			}
		});

		canvas.addEventListener('mousemove', (e) => {
			if (joystick.active) {
				const rect = canvas.getBoundingClientRect();
				const mouseX = e.clientX - rect.left;
				const mouseY = e.clientY - rect.top;
				moveJoystick(mouseX, mouseY);
			}
		});

		canvas.addEventListener('mouseup', () => {
			joystick.active = false;
			resetJoystick();
		});

		canvas.addEventListener('mouseleave', () => {
			joystick.active = false;
			resetJoystick();
		});

		canvas.addEventListener('touchstart', (e) => {
			const rect = canvas.getBoundingClientRect();
			const touchX = e.touches[0].clientX - rect.left;
			const touchY = e.touches[0].clientY - rect.top;

			const distance = Math.sqrt(
				Math.pow(touchX - joystick.x, 2) + Math.pow(touchY - joystick.y, 2)
			);

			if (distance <= joystick.radius) {
				joystick.active = true;
				moveJoystick(touchX, touchY);
			}
		});

		canvas.addEventListener('touchmove', (e) => {
			if (joystick.active) {
				const rect = canvas.getBoundingClientRect();
				const touchX = e.touches[0].clientX - rect.left;
				const touchY = e.touches[0].clientY - rect.top;
				moveJoystick(touchX, touchY);
			}
		});

		canvas.addEventListener('touchend', () => {
			joystick.active = false;
			resetJoystick();
		});

		// Animation loop
		const animate = () => {
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			updateBall();
			drawBall();
			drawJoystick();
			requestAnimationFrame(animate);
		};

		// Load ball image and start animation
		ballImage.onload = () => {
			ball.width = ballImage.width;
			ball.height = ballImage.height;
			animate();
		};
	</script>

	<!-- <div class="ad-container">
		<div class="game-container">
			<h1>Click the Moving Object</h1>
			<div class="game-area">
				<div id="moving-object"></div>
			</div>
			<div class="score">
				<p>Score: <span id="score">0</span></p>
			</div>
			<button id="start-button">Start Game</button>
		</div>

		<div class="cta">
			<button id="installButton">Install Now</button>
		</div>
	</div>

	<script src="script.js"></script> -->
</body>

</html>